@model  PMS.Models.User

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_myLayoutPage1.cshtml";
}

<div class="container">
    <div class="card card-register mx-auto mt-5">
        @if (ViewBag.Message != null)
        {
            <div class="alert alert-danger">@ViewBag.Message</div>
        }
        <div class="card-header">Register User</div>
        <div class="card-body">
            <form method="post" action="@Url.Action("../User/Save")">
                @Html.AntiForgeryToken()
                <div class="form-group">
                    <div class="form-row">
                        <input type="hidden" name="Id" value="@(Model != null ? Model.Id: 0)" />

                        <div class="col-md-6">
                            <div class="form-label-group">
                                <input type="text" id="inputfirstName" name="FirstName" value="@(Model != null ? Model.FirstName : "")" class="form-control" placeholder="First name" required="required" autofocus="autofocus">
                                <label for="inputfirstName">First name</label>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-label-group">
                                <input type="text" id="inputlastName" name="LastName" value="@(Model != null ? Model.LastName:"")" class="form-control" placeholder="Last name" required="required">
                                <label for="inputlastName">Last name</label>
                            </div>
                        </div>
                    </div>
                </div>   <!–– fname,lname-->

                <div class="form-group">
                    <div class="form-row">
                        <div class="col-md-6">
                            <div class="form-label-group">
                                <input type="text" id="inputmiddleName" name="MiddleName" value="@(Model !=null? Model.MiddleName:"")" class="form-control" placeholder="Middle name" required="required" autofocus="autofocus">
                                <label for="inputmiddleName">Middle name</label>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-label-group">
                                <input type="text" id="inputDOB" name="DOB" value="@(Model != null? Model.DOB:null)" class="form-control" placeholder="DOB" required="required">
                                <label for="inputDOB">DOB</label>
                            </div>
                        </div>
                    </div>
                </div>   <!–– middle name,dob-->

                <div class="form-group">
                    <div class="form-row">
                        <div class="col-md-6">
                            <div class="form-label-group" style="width:100%;">
                                <!--
                    <input type="number" id="inputrole_Id" name="Role_Id" class="form-control" placeholder="Role" required="required">
                    <label for="inputrole_Id">Role</label>  -->
                                @*@Html.DropDownList("Role_Id", ViewBag.RolesList as SelectList, "Choose Role")*@


                                <select id="Role_Id" name="Role_Id" style="width:100%;">
                                    <option id="0">---Select Role---</option>
                                    @foreach (PMS.Models.Role role in ViewBag.RolesList)
                                    {
                                        <option id="@role.Id" @(Model != null && Model.Role_Id == role.Id ? "selected" : "") value="@role.Id">@role.Title    </option>

                                    }
                                </select>

                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-md-6">
                            <div class="form-label-group">
                                <input type="text" id="inputuserName" name="UserName" value="@(Model !=null? Model.UserName:"")" class="form-control" placeholder="Username" required="required">
                                <label for="inputuserName">User Name</label>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-label-group">
                                <font color="red"> <label id="lbl_invalidUser"></label> </font>
</div>
                        </div>
                    </div>
                </div>

                <!–– user name,role-->

                <div class="form-group">
                    <div class="form-row">
                        <div class="col-md-6">
                            <div class="form-label-group">
                                <input type="password" id="inputPassword" name="Password" value="@(Model !=null? Model.Password:"")" class="form-control" placeholder="Password" required="required">
                                <label for="inputPassword">Password</label>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-label-group">
                                <input type="password" id="confirmPassword" class="form-control" placeholder="Confirm password" value="@(Model !=null? Model.Password:"")" required="required">
                                <label for="confirmPassword">Confirm password</label>
                            </div>
                        </div>
                    </div>
                </div>    <!–– passord,confirm-->

                <div class="form-group">
                    <div class="form-row">
                        <div class="col-md-6">
                            <div class="form-label-group">
                                <input type="tel" id="inputphone" name="Phone" value="@(Model !=null? Model.Phone:"")" class="form-control" placeholder="phone" required="required" autofocus="autofocus">
                                <label for="inputphone">Phone</label>
                            </div>
                        </div>
                        <div class="col-md-6">

                            <div class="form-label-group">
                                <select id="inputGender" name="Gender" style="width:100%;">
                                    <option value="0">--Select Gender--</option>
                                    <option value="1" @(Model != null && Model.Gender == 1 ? "selected" : "")>Male</option>
                                    <option value="2" @(Model != null && Model.Gender == 2 ? "selected" : "")>FeMale</option>
                                </select>

                            </div>

                        </div>
                    </div>
                </div>
                <!––phone,gender-->
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-md-6">
                                <div class="form-label-group">
                                    <input type="email" id="inputEmail" name="Email" value="@(Model !=null? Model.Email:"")" class="form-control" placeholder="Email address" required="required">
                                    <label for="inputEmail">Email address</label>

                                </div>
                        </div>

                                <div class="col-md-6">
                                    <div class="form-label-group">
                                      <font color="red">  <label id="lbl_invalidEmail" ></label></font>
                                    </div>
                                </div>
                            </div>
                    </div>
                <!–– email-->

                            <div class="form-group">
                                <div class="form-label-group">
                                    <input type="text" id="inputaddress" name="Address" value="@(Model !=null? Model.Address:"")" class="form-control" placeholder="address" required="required">
                                    <label for="inputaddress">Address</label>
                                </div>
                            </div>  <!–– address-->

                            <button type="submit" class="btn btn-primary btn-block">Register</button>
            </form>
        </div>
    </div>
</div>

<script type="text/javascript">
    $(document).ready(function () {

        $("#inputuserName").change(function () {
            //alert('value changed');
            var username = $(this).val();
            //alert(username);
            $.ajax({
                url: "@Url.Content("~/User/IsValid")",
                type: "POST",
                data: { UserName: username },

                success: function (reponse) {
                    //alert(reponse);
                    if (reponse == "True") {
                        $("#lbl_invalidUser").html("This user name already exists, please try any other!");
                    }
                    else {
                        $("#lbl_invalidUser").html("");
                    }
                }
        });
        });

    });



</script>

<script type="text/javascript">
    $(document).ready(function () {

        $("#inputEmail").change(function () {
            //alert('value changed');
            var email = $(this).val();
          //  alert(email);
            $.ajax({
                url: "@Url.Content("~/User/IsEmailValid")",
                type: "POST",
                data: { Email: email },

                success: function (reponse) {
                    //alert(reponse);
                    if (reponse == "True") {
                        $("#lbl_invalidEmail").html("This email is already taken, please try another!");
                    }
                    else {
                        $("#lbl_invalidEmail").html("");
                    }
                }
        });
        });

    });

</script>

